<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf8">
    <meta name="description" content="The official website for the Member Count Discord bot.">
    <meta name="author" content="lieuwe_berg#7122, CHamburr#2591">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#73c3ab">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://membercount.netlify.com">
    <meta property="og:title" content="Member Count">
    <meta property="og:description" content="The official website for the Member Count Discord bot.">
    <meta property="og:image" content="https://cdn.glitch.com/8e3492ef-dd7b-4c65-b27c-f566f0ed1254%2FPfP.png">

    <title>Stats | Member Count</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="icon" href="assets/logo.png" type="image/x-icon">

    <link rel="stylesheet" href="css/styles.css">
    
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.0.min.js"></script>
</head>

<body>
    <header>
        
    </header>
    <div class="container">
        <h2 style="text-align: center; margin: 4em 0 2em 0;">STATISTICS</h2>
        <div class="row" style="text-align: center;">
            <div class="col-4">
                <h5>Guilds</h5>
                <br>
                <p id="guilds"></p>
            </div>
            <div class="col-4">
                <h5>Users</h5>
                <br>
                <p id="users"></p>
            </div>
            <div class="col-4">
                <h5>Memory</h5>
                <br>
                <p id="memory"></p>
            </div>
        </div>
        <div class="row" id="clusters" style="margin-top: 4em;">
        </div>
    </div>

    <div style="background-color: #23272a; margin-top: 4em; padding: 1em 0;">
        <footer style="text-align: center;">
            <p>Â©2018-2019 lieuwe_berg and CHamburr</p>
        </footer>
    </div>

    <script>
        $(function() {
            $("header").load("nav.html");
        });

        fetch("https://membercount-api.glitch.me/stats")
            .then(res => res.json())
            .then(json => {
                document.getElementById("guilds").innerHTML = numberFormat(json.guilds);
                document.getElementById("users").innerHTML = numberFormat(json.users);
                document.getElementById("memory").innerHTML = (json.totalRam * 1000000 / 1048576 / 1024).toFixed(2) + "GB";

                let shards = 0;
                json.clusters.forEach(i => {
                    $("#clusters").append(`<div class="col-6 col-md-4 col-lg-3" style="margin: 0.5em 0; padding: 0 0.5em;"><div class="card bg-dark"><div class="card-body"><h5 class="card-title" style="text-align: center;">Cluster ${i.cluster}</h5><br><p><b>Shard</b> ${shards}-${shards + i.shards - 1}<br><b>Guilds</b> ${numberFormat(i.guilds)}<br><b>Uptime</b> ${(i.uptime / 3600000).toFixed(2)} hr(s)<br><b>Memory</b> ${(i.ram * 1000000 / 1048576).toFixed(2)}MB</p></div></div></div>`);
                    shards += i.shards;
                })
            });


        function numberFormat(number) {
            let parts = number.toString().split(".");
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return parts.join(".");
        }

    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129600306-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-129600306-2');
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>